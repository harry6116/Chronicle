Chronicle Version 9.3: Technical Methodology & Architecture

1. SYSTEM ARCHITECTURE
Chronicle operates as a client-side python wrapper for the Google Gemini API. It is designed to act as an accessible "Vision-Language" processor, converting unstructured visual data (PDFs, Images) and code files into structured, semantic text.

Data Flow:
[Local Input File] -> [Python Pre-Processor] -> [Encrypted API Upload] -> [Gemini 1.5 Pro/Flash Model] -> [Text Stream] -> [Python Post-Processor] -> [Local Output File]

2. INGESTION AND CHUNKING STRATEGY
Large Language Models (LLMs) have finite context windows. To process massive archival documents (e.g., a 500-page war diary) without crashing or hallucinating, Chronicle employs a strict "Chunking" strategy.

* PDFs: The pypdf library splits documents into 5-page temporary artifacts. This high-resolution chunking ensures that complex pages (like Tables of Contents or dense manuals) are never skipped or summarized.
* Text/Word/Code: The python-docx library splits raw text and code files (.txt, .md, .js) based on a strict character limit (15,000 chars) to ensure optimal processing speed.
* Batch Directory Scanning: The script utilizes an os.walk recursive scan to traverse nested sub-folders within the "Input_Scans" directory. This allows users to drop entire archival folder trees into the engine. It also features an optional memory-management toggle to delete the original source files upon successful conversion.

3. THE "VISION-LANGUAGE" ENGINE
Chronicle uses a multimodal approach. It does not just look for characters (like OCR); it looks for context.

* Technical Manual Translation: The AI is explicitly instructed to act as a UI translator. If a user manual utilizes standalone visual icons (like a gear, triangle, or trash can) instead of text, the model converts the pixel data of the icon into explicit, bracketed text. Device schematics mapping parts via numbered arrows are actively rebuilt into linear, spatially-aware lists.
* Military Archive Intelligence: The AI actively isolates diagonal security stamps (e.g., TOP SECRET) and reconstructs routing blocks (From/To) to establish clear context. It repairs unpunctuated telegraph cables by decoding the word "STOP", and forces the spacing of topographic map coordinates to guarantee precise audio dictation by screen readers.
* Form Flattening Logic: When the AI detects a structured form, it is instructed via system prompt to ignore the visual XY coordinates. Instead, it "flattens" the data into a key-value pair list.
* Checkbox State Detection: The Vision model analyzes the pixel data of checkboxes to determine if they contain a checkmark, cross, or fill. It then outputs a semantic tag: [Checkbox: Selected] or [Checkbox: Empty].

4. GUARDRAILS AND SAFETY

A. The "Double-Lock" Encoding Fix (Mojibake Prevention)
Encoding errors (Mojibake) occur when AI generates "smart" punctuation that older text readers misinterpret as garbage characters. Chronicle solves this with a two-layer system:
* Layer 1 (Prompt Level): The system prompt explicitly forbids the AI from generating non-ASCII punctuation.
* Layer 2 (Python Scrubber): A dedicated function (clean_text_artifacts) runs on every incoming text chunk. It scans for specific byte-order marks and corrupted UTF-8 artifacts and replaces them with standard ASCII equivalents.

B. Uncensored Historical Accuracy
Standard AI models often have "safety filters" that mask profanity. Chronicle bypasses this for historical accuracy by injecting a specific "Uncensored Transcription" directive into the system prompt. This instructs the model to treat the document as an immutable historical record.

C. Terminal Noise Suppression
Archival PDFs often contain corrupted cross-reference tables (e.g., offset 0 errors). To prevent these structural errors from flooding the terminal and overwhelming screen readers, Chronicle actively suppresses non-critical warnings from the pypdf logger.

5. OUTPUT GENERATION

* Semantic HTML: The script constructs valid HTML5 without wrapper tags in individual chunks, but concatenates them into a valid DOM structure at the end.
* PDF Generation: Chronicle uses the fpdf2 library. To prevent encoding crashes, it forces a Latin-1 compatible character set during PDF creation.

6. DATA PRIVACY NOTE
Chronicle is a "Stateless" application. It holds user data in RAM only for the duration of the processing session. Temporary files are immediately deleted after upload. Chronicle does not maintain a database or persistent log of user content.